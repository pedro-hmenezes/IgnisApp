// ============================================
// üìù EXEMPLOS DE ASSINATURA DIGITAL
// ============================================

// ============================================
// 1. ASSINAR OCORR√äNCIA (FINALIZAR)
// ============================================

POST http://localhost:3000/api/signatures/sign
Authorization: Bearer seu-token-jwt-aqui
Content-Type: application/json

{
  "occurrenceId": "670f3a8c2b8d4e9f1a2b3c4d",
  "signerName": "Jo√£o Silva Santos",
  "signatureData": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==",
  "signerRole": "Bombeiro",
  "screenResolution": "1920x1080"
}

// Response (201):
{
  "sucesso": true,
  "mensagem": "‚úÖ Assinatura registrada com sucesso!",
  "dados": {
    "signature": {
      "_id": "670f3a8c2b8d4e9f1a2b3c4d",
      "signerName": "Jo√£o Silva Santos",
      "signerRole": "Bombeiro",
      "signedAt": "2024-12-06T10:30:00.000Z",
      "occurrence": {
        "_id": "670f3a8c2b8d4e9f1a2b3c4e",
        "numAviso": "AVG-2024-001",
        "statusGeral": "finalizada",
        "finalizadoEm": "2024-12-06T10:30:00.000Z"
      }
    }
  }
}

// ============================================
// 2. OBTER ASSINATURA DE UMA OCORR√äNCIA
// ============================================

GET http://localhost:3000/api/signatures/occurrence/670f3a8c2b8d4e9f1a2b3c4d

// Response (200):
{
  "sucesso": true,
  "dados": {
    "_id": "670f3a8c2b8d4e9f1a2b3c4d",
    "occurrenceId": "670f3a8c2b8d4e9f1a2b3c4e",
    "signerName": "Jo√£o Silva Santos",
    "signerRole": "Bombeiro",
    "signatureData": "data:image/png;base64,...",
    "signedAt": "2024-12-06T10:30:00.000Z",
    "ipAddress": "192.168.1.100",
    "userAgent": "Mozilla/5.0...",
    "deviceInfo": {
      "platform": "desktop",
      "screenResolution": "1920x1080",
      "timestamp": "2024-12-06T10:30:00.000Z"
    }
  }
}

// ============================================
// 3. OBTER ASSINATURA POR ID
// ============================================

GET http://localhost:3000/api/signatures/670f3a8c2b8d4e9f1a2b3c4d

// ============================================
// 4. LISTAR MINHAS ASSINATURAS
// ============================================

GET http://localhost:3000/api/signatures/user/my-signatures
Authorization: Bearer seu-token-jwt-aqui

// Response (200):
{
  "sucesso": true,
  "total": 15,
  "dados": [
    {
      "_id": "670f3a8c2b8d4e9f1a2b3c4d",
      "signerName": "Jo√£o Silva",
      "signedAt": "2024-12-06T10:30:00.000Z",
      ...
    },
    ...
  ]
}

// ============================================
// 5. ATUALIZAR ASSINATURA
// ============================================

PATCH http://localhost:3000/api/signatures/670f3a8c2b8d4e9f1a2b3c4d
Authorization: Bearer seu-token-jwt-aqui
Content-Type: application/json

{
  "signerRole": "Coordenador"
}

// Response (200):
{
  "sucesso": true,
  "mensagem": "‚úÖ Assinatura atualizada com sucesso!",
  "dados": { ... }
}

// ============================================
// 6. DELETAR ASSINATURA
// ============================================

DELETE http://localhost:3000/api/signatures/670f3a8c2b8d4e9f1a2b3c4d
Authorization: Bearer seu-token-jwt-aqui

// Response (200):
{
  "sucesso": true,
  "mensagem": "‚úÖ Assinatura deletada com sucesso!"
}

// ============================================
// 7. OBTER ESTAT√çSTICAS
// ============================================

GET http://localhost:3000/api/signatures/stats/all
Authorization: Bearer seu-token-jwt-aqui

// Response (200):
{
  "sucesso": true,
  "dados": {
    "totalSignatures": 150,
    "finalizedOccurrences": 150,
    "averageSigningTime": 45
  }
}

// ============================================
// EXEMPLOS COM cURL
// ============================================

// Assinar ocorr√™ncia
curl -X POST http://localhost:3000/api/signatures/sign \
  -H "Authorization: Bearer seu-token" \
  -H "Content-Type: application/json" \
  -d '{
    "occurrenceId": "670f3a8c2b8d4e9f1a2b3c4d",
    "signerName": "Jo√£o Silva",
    "signatureData": "data:image/png;base64,...",
    "signerRole": "Bombeiro"
  }'

// Obter assinatura
curl -X GET http://localhost:3000/api/signatures/occurrence/670f3a8c2b8d4e9f1a2b3c4d

// Listar minhas assinaturas
curl -X GET http://localhost:3000/api/signatures/user/my-signatures \
  -H "Authorization: Bearer seu-token"

// Deletar
curl -X DELETE http://localhost:3000/api/signatures/670f3a8c2b8d4e9f1a2b3c4d \
  -H "Authorization: Bearer seu-token"

// ============================================
// ERROS POSS√çVEIS
// ============================================

// 400 - Campos obrigat√≥rios faltando
{
  "sucesso": false,
  "mensagem": "‚ùå Campos obrigat√≥rios: occurrenceId, signerName, signatureData",
  "campos": ["occurrenceId", "signerName", "signatureData"]
}

// 400 - Assinatura inv√°lida
{
  "sucesso": false,
  "mensagem": "‚ùå Dados de assinatura inv√°lidos (deve ser base64 ou URL v√°lida)"
}

// 401 - N√£o autenticado
{
  "sucesso": false,
  "mensagem": "‚ùå Usu√°rio n√£o autenticado"
}

// 404 - N√£o encontrado
{
  "sucesso": false,
  "mensagem": "‚ùå Assinatura n√£o encontrada para esta ocorr√™ncia"
}

// 500 - Erro ao assinar (ex: ocorr√™ncia j√° finalizada)
{
  "sucesso": false,
  "mensagem": "‚ùå Erro ao registrar assinatura: N√£o √© poss√≠vel assinar ocorr√™ncia com status: finalizada"
}

// ============================================
// FORMATO DE DADOS
// ============================================

// Signature Document
{
  _id: ObjectId("670f3a8c2b8d4e9f1a2b3c4d"),
  occurrenceId: ObjectId("670f3a8c2b8d4e9f1a2b3c4e"),
  signerName: "Jo√£o Silva Santos",
  signerRole: "Bombeiro",
  signatureData: "data:image/png;base64,iVBORw0KGgoAAAA...",
  signedAt: ISODate("2024-12-06T10:30:00.000Z"),
  ipAddress: "192.168.1.100",
  userAgent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64)...",
  deviceInfo: {
    platform: "desktop",
    screenResolution: "1920x1080",
    timestamp: ISODate("2024-12-06T10:30:00.000Z")
  },
  createdAt: ISODate("2024-12-06T10:30:00.000Z"),
  updatedAt: ISODate("2024-12-06T10:30:00.000Z")
}

// Occurrence Document (atualizado)
{
  _id: ObjectId("670f3a8c2b8d4e9f1a2b3c4e"),
  numAviso: "AVG-2024-001",
  ...outros campos...,
  statusGeral: "finalizada",
  finalizadoPor: ObjectId("670f3a8c2b8d4e9f1a2b3c4f"),
  finalizadoEm: ISODate("2024-12-06T10:30:00.000Z"),
  signature: ObjectId("670f3a8c2b8d4e9f1a2b3c4d")
}
